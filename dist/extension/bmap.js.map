{"version":3,"file":"bmap.js","sources":["../../extension-src/bmap/BMapCoordSys.js","../../extension-src/bmap/BMapModel.js","../../extension-src/bmap/BMapView.js","../../extension-src/bmap/bmap.js"],"sourcesContent":["/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n/* global BMap */\r\n\r\nimport {\r\n    util as zrUtil,\r\n    graphic,\r\n    matrix\r\n} from 'echarts';\r\n\r\nfunction BMapCoordSys(bmap, api) {\r\n    this._bmap = bmap;\r\n    this.dimensions = ['lng', 'lat'];\r\n    this._mapOffset = [0, 0];\r\n\r\n    this._api = api;\r\n\r\n    this._projection = new BMap.MercatorProjection();\r\n}\r\n\r\nBMapCoordSys.prototype.dimensions = ['lng', 'lat'];\r\n\r\nBMapCoordSys.prototype.setZoom = function (zoom) {\r\n    this._zoom = zoom;\r\n};\r\n\r\nBMapCoordSys.prototype.setCenter = function (center) {\r\n    this._center = this._projection.lngLatToPoint(new BMap.Point(center[0], center[1]));\r\n};\r\n\r\nBMapCoordSys.prototype.setMapOffset = function (mapOffset) {\r\n    this._mapOffset = mapOffset;\r\n};\r\n\r\nBMapCoordSys.prototype.getBMap = function () {\r\n    return this._bmap;\r\n};\r\n\r\nBMapCoordSys.prototype.dataToPoint = function (data) {\r\n    var point = new BMap.Point(data[0], data[1]);\r\n    // TODO mercator projection is toooooooo slow\r\n    // var mercatorPoint = this._projection.lngLatToPoint(point);\r\n\r\n    // var width = this._api.getZr().getWidth();\r\n    // var height = this._api.getZr().getHeight();\r\n    // var divider = Math.pow(2, 18 - 10);\r\n    // return [\r\n    //     Math.round((mercatorPoint.x - this._center.x) / divider + width / 2),\r\n    //     Math.round((this._center.y - mercatorPoint.y) / divider + height / 2)\r\n    // ];\r\n    var px = this._bmap.pointToOverlayPixel(point);\r\n    var mapOffset = this._mapOffset;\r\n    return [px.x - mapOffset[0], px.y - mapOffset[1]];\r\n};\r\n\r\nBMapCoordSys.prototype.pointToData = function (pt) {\r\n    var mapOffset = this._mapOffset;\r\n    var pt = this._bmap.overlayPixelToPoint({\r\n        x: pt[0] + mapOffset[0],\r\n        y: pt[1] + mapOffset[1]\r\n    });\r\n    return [pt.lng, pt.lat];\r\n};\r\n\r\nBMapCoordSys.prototype.getViewRect = function () {\r\n    var api = this._api;\r\n    return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight());\r\n};\r\n\r\nBMapCoordSys.prototype.getRoamTransform = function () {\r\n    return matrix.create();\r\n};\r\n\r\nBMapCoordSys.prototype.prepareCustoms = function (data) {\r\n    var rect = this.getViewRect();\r\n    return {\r\n        coordSys: {\r\n            // The name exposed to user is always 'cartesian2d' but not 'grid'.\r\n            type: 'bmap',\r\n            x: rect.x,\r\n            y: rect.y,\r\n            width: rect.width,\r\n            height: rect.height\r\n        },\r\n        api: {\r\n            coord: zrUtil.bind(this.dataToPoint, this),\r\n            size: zrUtil.bind(dataToCoordSize, this)\r\n        }\r\n    };\r\n};\r\n\r\nfunction dataToCoordSize(dataSize, dataItem) {\r\n    dataItem = dataItem || [0, 0];\r\n    return zrUtil.map([0, 1], function (dimIdx) {\r\n        var val = dataItem[dimIdx];\r\n        var halfSize = dataSize[dimIdx] / 2;\r\n        var p1 = [];\r\n        var p2 = [];\r\n        p1[dimIdx] = val - halfSize;\r\n        p2[dimIdx] = val + halfSize;\r\n        p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx];\r\n        return Math.abs(this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]);\r\n    }, this);\r\n}\r\n\r\nvar Overlay;\r\n\r\n// For deciding which dimensions to use when creating list data\r\nBMapCoordSys.dimensions = BMapCoordSys.prototype.dimensions;\r\n\r\nfunction createOverlayCtor() {\r\n    function Overlay(root) {\r\n        this._root = root;\r\n    }\r\n\r\n    Overlay.prototype = new BMap.Overlay();\r\n    /**\r\n     * 初始化\r\n     *\r\n     * @param {BMap.Map} map\r\n     * @override\r\n     */\r\n    Overlay.prototype.initialize = function (map) {\r\n        map.getPanes().labelPane.appendChild(this._root);\r\n        return this._root;\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    Overlay.prototype.draw = function () {};\r\n\r\n    return Overlay;\r\n}\r\n\r\nBMapCoordSys.create = function (ecModel, api) {\r\n    var bmapCoordSys;\r\n    var root = api.getDom();\r\n\r\n    // TODO Dispose\r\n    ecModel.eachComponent('bmap', function (bmapModel) {\r\n        var painter = api.getZr().painter;\r\n        var viewportRoot = painter.getViewportRoot();\r\n        if (typeof BMap === 'undefined') {\r\n            throw new Error('BMap api is not loaded');\r\n        }\r\n        Overlay = Overlay || createOverlayCtor();\r\n        if (bmapCoordSys) {\r\n            throw new Error('Only one bmap component can exist');\r\n        }\r\n        if (!bmapModel.__bmap) {\r\n            // Not support IE8\r\n            var bmapRoot = root.querySelector('.ec-extension-bmap');\r\n            if (bmapRoot) {\r\n                // Reset viewport left and top, which will be changed\r\n                // in moving handler in BMapView\r\n                viewportRoot.style.left = '0px';\r\n                viewportRoot.style.top = '0px';\r\n                root.removeChild(bmapRoot);\r\n            }\r\n            bmapRoot = document.createElement('div');\r\n            bmapRoot.style.cssText = 'width:100%;height:100%';\r\n            // Not support IE8\r\n            bmapRoot.classList.add('ec-extension-bmap');\r\n            root.appendChild(bmapRoot);\r\n            var bmap = bmapModel.__bmap = new BMap.Map(bmapRoot);\r\n\r\n            var overlay = new Overlay(viewportRoot);\r\n            bmap.addOverlay(overlay);\r\n\r\n            // Override\r\n            painter.getViewportRootOffset = function () {\r\n                return {offsetLeft: 0, offsetTop: 0};\r\n            };\r\n        }\r\n        var bmap = bmapModel.__bmap;\r\n\r\n        // Set bmap options\r\n        // centerAndZoom before layout and render\r\n        var center = bmapModel.get('center');\r\n        var zoom = bmapModel.get('zoom');\r\n        if (center && zoom) {\r\n            var pt = new BMap.Point(center[0], center[1]);\r\n            bmap.centerAndZoom(pt, zoom);\r\n        }\r\n\r\n        bmapCoordSys = new BMapCoordSys(bmap, api);\r\n        bmapCoordSys.setMapOffset(bmapModel.__mapOffset || [0, 0]);\r\n        bmapCoordSys.setZoom(zoom);\r\n        bmapCoordSys.setCenter(center);\r\n\r\n        bmapModel.coordinateSystem = bmapCoordSys;\r\n    });\r\n\r\n    ecModel.eachSeries(function (seriesModel) {\r\n        if (seriesModel.get('coordinateSystem') === 'bmap') {\r\n            seriesModel.coordinateSystem = bmapCoordSys;\r\n        }\r\n    });\r\n};\r\n\r\nexport default BMapCoordSys;","/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\nimport * as echarts from 'echarts';\r\n\r\nfunction v2Equal(a, b) {\r\n    return a && b && a[0] === b[0] && a[1] === b[1];\r\n}\r\n\r\nexport default echarts.extendComponentModel({\r\n    type: 'bmap',\r\n\r\n    getBMap: function () {\r\n        // __bmap is injected when creating BMapCoordSys\r\n        return this.__bmap;\r\n    },\r\n\r\n    setCenterAndZoom: function (center, zoom) {\r\n        this.option.center = center;\r\n        this.option.zoom = zoom;\r\n    },\r\n\r\n    centerOrZoomChanged: function (center, zoom) {\r\n        var option = this.option;\r\n        return !(v2Equal(center, option.center) && zoom === option.zoom);\r\n    },\r\n\r\n    defaultOption: {\r\n\r\n        center: [104.114129, 37.550339],\r\n\r\n        zoom: 5,\r\n\r\n        mapStyle: {},\r\n\r\n        mapStyleV2: {},\r\n\r\n        roam: false\r\n    }\r\n});","/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\nimport * as echarts from 'echarts';\r\n\r\nexport default echarts.extendComponentView({\r\n    type: 'bmap',\r\n\r\n    render: function (bMapModel, ecModel, api) {\r\n        var rendering = true;\r\n\r\n        var bmap = bMapModel.getBMap();\r\n        var viewportRoot = api.getZr().painter.getViewportRoot();\r\n        var coordSys = bMapModel.coordinateSystem;\r\n        var moveHandler = function (type, target) {\r\n            if (rendering) {\r\n                return;\r\n            }\r\n            var offsetEl = viewportRoot.parentNode.parentNode.parentNode;\r\n            var mapOffset = [\r\n                -parseInt(offsetEl.style.left, 10) || 0,\r\n                -parseInt(offsetEl.style.top, 10) || 0\r\n            ];\r\n            viewportRoot.style.left = mapOffset[0] + 'px';\r\n            viewportRoot.style.top = mapOffset[1] + 'px';\r\n\r\n            coordSys.setMapOffset(mapOffset);\r\n            bMapModel.__mapOffset = mapOffset;\r\n\r\n            api.dispatchAction({\r\n                type: 'bmapRoam'\r\n            });\r\n        };\r\n\r\n        function zoomEndHandler() {\r\n            if (rendering) {\r\n                return;\r\n            }\r\n            api.dispatchAction({\r\n                type: 'bmapRoam'\r\n            });\r\n        }\r\n\r\n        bmap.removeEventListener('moving', this._oldMoveHandler);\r\n        // FIXME\r\n        // Moveend may be triggered by centerAndZoom method when creating coordSys next time\r\n        // bmap.removeEventListener('moveend', this._oldMoveHandler);\r\n        bmap.removeEventListener('zoomend', this._oldZoomEndHandler);\r\n        bmap.addEventListener('moving', moveHandler);\r\n        // bmap.addEventListener('moveend', moveHandler);\r\n        bmap.addEventListener('zoomend', zoomEndHandler);\r\n\r\n        this._oldMoveHandler = moveHandler;\r\n        this._oldZoomEndHandler = zoomEndHandler;\r\n\r\n        var roam = bMapModel.get('roam');\r\n        if (roam && roam !== 'scale') {\r\n            bmap.enableDragging();\r\n        }\r\n        else {\r\n            bmap.disableDragging();\r\n        }\r\n        if (roam && roam !== 'move') {\r\n            bmap.enableScrollWheelZoom();\r\n            bmap.enableDoubleClickZoom();\r\n            bmap.enablePinchToZoom();\r\n        }\r\n        else {\r\n            bmap.disableScrollWheelZoom();\r\n            bmap.disableDoubleClickZoom();\r\n            bmap.disablePinchToZoom();\r\n        }\r\n\r\n        /* map 2.0 */\r\n        var originalStyle = bMapModel.__mapStyle;\r\n\r\n        var newMapStyle = bMapModel.get('mapStyle') || {};\r\n        // FIXME, Not use JSON methods\r\n        var mapStyleStr = JSON.stringify(newMapStyle);\r\n        if (JSON.stringify(originalStyle) !== mapStyleStr) {\r\n            // FIXME May have blank tile when dragging if setMapStyle\r\n            if (Object.keys(newMapStyle).length) {\r\n                bmap.setMapStyle(newMapStyle);\r\n            }\r\n            bMapModel.__mapStyle = JSON.parse(mapStyleStr);\r\n        }\r\n\r\n        /* map 3.0 */\r\n        var originalStyle2 = bMapModel.__mapStyle2;\r\n\r\n        var newMapStyle2 = bMapModel.get('mapStyleV2') || {};\r\n        // FIXME, Not use JSON methods\r\n        var mapStyleStr2 = JSON.stringify(newMapStyle2);\r\n        if (JSON.stringify(originalStyle2) !== mapStyleStr2) {\r\n            // FIXME May have blank tile when dragging if setMapStyle\r\n            if (Object.keys(newMapStyle2).length) {\r\n                bmap.setMapStyleV2(newMapStyle2);\r\n            }\r\n            bMapModel.__mapStyle2 = JSON.parse(mapStyleStr2);\r\n        }\r\n\r\n        rendering = false;\r\n    }\r\n});","/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n/**\r\n * BMap component extension\r\n */\r\n\r\nimport * as echarts from 'echarts';\r\nimport BMapCoordSys from './BMapCoordSys';\r\n\r\nimport './BMapModel';\r\nimport './BMapView';\r\n\r\necharts.registerCoordinateSystem('bmap', BMapCoordSys);\r\n\r\n// Action\r\necharts.registerAction({\r\n    type: 'bmapRoam',\r\n    event: 'bmapRoam',\r\n    update: 'updateLayout'\r\n}, function (payload, ecModel) {\r\n    ecModel.eachComponent('bmap', function (bMapModel) {\r\n        var bmap = bMapModel.getBMap();\r\n        var center = bmap.getCenter();\r\n        bMapModel.setCenterAndZoom([center.lng, center.lat], bmap.getZoom());\r\n    });\r\n});\r\n\r\nexport var version = '1.0.0';\r\n"],"names":["graphic","matrix","zrUtil","echarts.extendComponentModel","echarts.extendComponentView","echarts.registerCoordinateSystem","echarts.registerAction"],"mappings":"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"}